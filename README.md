# Project_template

# –ó–∞–¥–∞–Ω–∏–µ 1. –ê–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É–¥–∞–ª—ë–Ω–Ω–æ –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –æ—Ç–æ–ø–ª–µ–Ω–∏—è –≤ —Å–≤–æ–∏—Ö –¥–æ–º–∞—Ö —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ–Ω—Å–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "active" –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è)
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ: —Å–µ—Ä–≤–µ—Ä –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –º–æ–¥—É–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–≤–∫–ª/–≤—ã–∫–ª)
- –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏
- –ö —Å–∏—Å—Ç–µ–º–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã 100 –º–æ–¥—É–ª–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º –∏ 100 –≤–µ–±-–∫–ª–∏–µ–Ω—Ç–æ–≤

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã:**
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≤ –¥–æ–º–∞—Ö —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ: —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∏—è —Å –¥–∞—Ç—á–∏–∫–æ–≤ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
- –°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –≤ PostgreSQL
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∏–ø –¥–∞—Ç—á–∏–∫–æ–≤ - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ–∏—Å–∫ –ø–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é (`GET /api/v1/sensors/temperature/:location`)

### 2. –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### **1. –°—Ö–µ–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

```mermaid
flowchart TD
    A[–ö–ª–∏–µ–Ω—Ç] --> B[Gin Router]
    B --> C[SensorHandler]
    C --> D[DB Module]
    D --> E[(PostgreSQL)]
    C --> F[TemperatureService]
    F --> G[External HTTP API]
```

#### **2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã:**
| **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç**           | **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è/–ü–æ–¥—Ö–æ–¥**             | **–û–ø–∏—Å–∞–Ω–∏–µ**                                                                 |
|--------------------------|-----------------------------------|-----------------------------------------------------------------------------|
| –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è    | Go (Golang)                       | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è backend-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö              | PostgreSQL                        | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–Ω—Å–æ—Ä–∞—Ö –∏ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö        |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è   | –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è                        | –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –∫–∞–∫ –µ–¥–∏–Ω–æ–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ                |
| –°—Ç–∏–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è     | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST API               | –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ HTTP-–≤—ã–∑–æ–≤—ã –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∏ –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏            |
| –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏| –ü—Ä—è–º—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã              | –°–µ—Ä–≤–µ—Ä –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –±—Ä–æ–∫–µ—Ä–æ–≤         |
| –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ            | Docker Compose                    | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ë–î —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `init.sh`              |

#### **3. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã:**
```plaintext
smart_home/
‚îú‚îÄ‚îÄ db/             # –†–∞–±–æ—Ç–∞ —Å –ë–î (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏)
‚îÇ   ‚îî‚îÄ‚îÄ db.go
‚îú‚îÄ‚îÄ handlers/       | HTTP-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (REST API)
‚îÇ   ‚îî‚îÄ‚îÄ sensors.go  | 
‚îú‚îÄ‚îÄ models/         | –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—Å—É—â–Ω–æ—Å—Ç–∏)
‚îÇ   ‚îî‚îÄ‚îÄ sensor.go   | 
‚îî‚îÄ‚îÄ services/       | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
    ‚îî‚îÄ‚îÄ temperature_service.go
```

#### **4. Sequence-diagram**

```mermaid
sequenceDiagram
    participant Client
    participant Handler
    participant DB
    participant TemperatureService
    participant ExternalAPI

    Client->>Handler: HTTP Request
    Handler->>DB: GetSensorByID()
    DB-->>Handler: Sensor Data

    Handler->>TemperatureService: GetTemperatureByID()
    TemperatureService->>ExternalAPI: HTTP GET
    ExternalAPI-->TemperatureService: JSON Response
    TemperatureService-->Handler: TemperatureResponse

    Handler-->Client: HTTP Response
```

### 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –∏ –≥—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

```mermaid
graph TD
    A[–£–º–Ω—ã–π –î–æ–º] --> B[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏]
    A --> D[–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è]
    A --> E[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏]
    A --> G[–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞]
    A --> I[–§—Ä–æ–Ω—Ç]
```

#### 1. –î–æ–º–µ–Ω "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏"
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ —Ç–∏–ø–∞–º (—Å–µ–Ω—Å–æ—Ä—ã, —Ä–µ–ª–µ, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã)
    

**–ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
```mermaid
graph LR
    A[–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ] --> B[–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è]
    A --> C[–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è]
    A --> D[–°–æ—Å—Ç–æ—è–Ω–∏–µ]
    A --> E[–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞]
    
    B --> F[–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä]
    B --> G[–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å]
    B --> H[–í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏]
    
    C --> I[–ù–∞—Å—Ç—Ä–æ–π–∫–∏]
    C --> J[–ü–∞—Ä–∞–º–µ—Ç—Ä—ã]
    
    D --> K[–û–Ω–ª–∞–π–Ω/–û—Ñ–ª–∞–π–Ω]
    D --> L[–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–≥–Ω–∞–ª]
    
    E --> M[–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞]
    E --> N[–û—Å–≤–µ—â–µ–Ω–∏–µ]
    E --> O[–í–æ—Ä–æ—Ç–∞]
```

**–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
- –ê–≥—Ä–µ–≥–∞—Ç `Device` (–∫–æ—Ä–Ω–µ–≤–æ–π –æ–±—ä–µ–∫—Ç)
- –°–µ—Ä–≤–∏—Å—ã: `DeviceRegistrationService`, `DeviceConfigurationService`
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `DeviceRepository`
- –°–æ–±—ã—Ç–∏—è: `DeviceRegistered`, `DeviceStatusChanged`
    
#### 2. –î–æ–º–µ–Ω  **"–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è"**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏ —É—Å–ª–æ–≤–∏–π
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    

**–ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**

```mermaid
graph LR
    A[–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è] --> B[–°—Ü–µ–Ω–∞—Ä–∏–∏]
    A --> C[–¢—Ä–∏–≥–≥–µ—Ä—ã]
    A --> D[–î–µ–π—Å—Ç–≤–∏—è]
    
    B --> E[IF-THEN –ø—Ä–∞–≤–∏–ª–∞]
    B --> F[–†–∞—Å–ø–∏—Å–∞–Ω–∏—è]
    
    C --> G[–ü–æ –≤—Ä–µ–º–µ–Ω–∏]
    C --> H[–ü–æ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º]
    C --> I[–ü–æ —Å–æ–±—ã—Ç–∏—è–º]
    
    D --> J[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏]
    D --> K[–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è]
```
    
#### 3. –î–æ–º–µ–Ω  **"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –î–æ—Å—Ç—É–ø"**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
- –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å
    
**–ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏] --> B[–ü—Ä–æ—Ñ–∏–ª–∏]
    A --> C[–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è]
    A --> D[–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è]
    
    B --> E[–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ]
    B --> F[–ù–∞—Å—Ç—Ä–æ–π–∫–∏]
    
    C --> G[OAuth 2.0]
    C --> H[JWT]
    
    D --> I[RBAC]
    D --> J[ABAC]
```
    
#### 4. –î–æ–º–µ–Ω  **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π"**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ä–µ–¥—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
    
**–ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**

```mermaid
graph LR
    A[–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞] --> B[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥]
    A --> C[–û–±–Ω–æ–≤–ª–µ–Ω–∏—è]
    A --> D[–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è]
    A --> K[–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è]
    
    B --> E[–ú–µ—Ç—Ä–∏–∫–∏]
    B --> F[–õ–æ–≥–∏]
    
    C --> G[OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏—è]
    C --> H[–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ]
    
    D --> I[–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã]
    D --> J[–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è]

    K --> O[–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞]
    
```

#### 5. –î–æ–º–µ–Ω  **"–§—Ä–æ–Ω—Ç"**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π:
    - **Web UI** ‚Äî –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤).
    - **Mobile App** ‚Äî –¥–ª—è –º–æ–Ω—Ç–∞–∂–Ω–∏–∫–æ–≤ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è).
    - **Admin Panel** ‚Äî –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –º–æ–Ω—Ç–∞–∂–Ω–∏–∫, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API Gateway –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –≤—ã–∑–æ–≤–∞ backend-—Å–µ—Ä–≤–∏—Å–æ–≤.
    
**–ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**

```mermaid
graph LR
    A[–§—Ä–æ–Ω—Ç] --> B[Web UI]
    A --> C[Mobile App]
    A --> D[Admin Panel]
    A --> E[API Gateway]
    
    B --> F[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏]
    B --> G[–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏]
    B --> H[–°—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏]
    
    C --> I[–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤]
    C --> J[–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è]
    
    D --> K[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏]
    D --> L[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫]
    
    E --> M[–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Auth Service]
    E --> N[–í—ã–∑–æ–≤—ã Device/Telemetry/Rule Engine API]
```

### **4. –ü—Ä–æ–±–ª–µ–º—ã –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è**

#### 1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**
| **–ü—Ä–æ–±–ª–µ–º–∞**                | **–û–ø–∏—Å–∞–Ω–∏–µ**                                                                 | **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**                                                                 |
|-----------------------------|-----------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| **–í—ã—Å–æ–∫–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å**     | –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ—Å–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ                         | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è               |
| **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏**  | –ù–µ—Ç —á–µ—Ç–∫–∏—Ö –≥—Ä–∞–Ω–∏—Ü –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)     | –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–æ—Å–≤–µ—â–µ–Ω–∏–µ, –≤–æ—Ä–æ—Ç–∞)                 |
| **–ë–ª–æ–∫–∏—Ä—É—é—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∫–æ –≤—Å–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º                                      | –í–µ—Å—å —Å–µ—Ä–≤–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ–¥–Ω–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞ –∏–ª–∏ –≤–Ω–µ—à–Ω–µ–≥–æ API      |

#### 2. **–ü—Ä–æ–±–ª–µ–º—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏**
| **–ü—Ä–æ–±–ª–µ–º–∞**                     | **–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞**                                                                 | **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**                                       |
|----------------------------------|-----------------------------------------------------------------------------------|------------------------------------------------------|
| **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** | –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã                                 | –ú–∞–∫—Å–∏–º—É–º 500-1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π         |
| **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è**      | –í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `sensors`                                 | –ë–æ—Ç—Ç–ª–Ω–µ–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å–∞—Ö –ø—Ä–∏ >10K —É—Å—Ç—Ä–æ–π—Å—Ç–≤              |
| **–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**        | –°—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è                                    | –ß–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ PostgreSQL —Å–Ω–∏–∂–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |

#### 3. **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
```go
// handlers/sensors.go - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—á–∞—Å—Ç–æ–∫ –∫–æ–¥–∞
func (h *SensorHandler) GetSensors(c *gin.Context) {
    sensors, err := h.DB.GetSensors(context.Background()) // –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤ –ë–î
    for i, sensor := range sensors {
        if sensor.Type == models.Temperature {
            // –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ API –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞!
            tempData, err := h.TemperatureService.GetTemperatureByID(...)
            // ...
        }
    }
}
```
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —Ä–∞—Å—Ç—ë—Ç –ª–∏–Ω–µ–π–Ω–æ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (O(n))
- –û–¥–∏–Ω –º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–∞—Ç—á–∏–∫ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ—Å—å –æ—Ç–≤–µ—Ç
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### 4. **–ü—Ä–æ–±–ª–µ–º—ã —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**
| **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**                 | **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –º–æ–Ω–æ–ª–∏—Ç–µ**                                                                 |
|--------------------------------|----------------------------------------------------------------------------------------|
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤**  | –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–∑–º–µ–Ω—è—Ç—å —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (–¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤ `SensorType`)                  |
| **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**  | –ù–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª (if temperature > 25 then turn off heating)   |
| **–°–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ**           | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫–æ–Ω–µ—á–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏                     |

#### 5. **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**
| **–ü—Ä–æ–±–ª–µ–º–∞**               | **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏–∑ –∫–æ–¥–∞/–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**                               | **–†–∏—Å–∫**                                                |
|----------------------------|-------------------------------------------------------------------------|--------------------------------------------------------|
| **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞**    | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è = –ø–æ–ª–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã                    | –ù–∞—Ä—É—à–µ–Ω–∏–µ SLAs –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö                         |
| **–°–ª–æ–∂–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**  | `docker-compose up -d` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å—é —Å–∏—Å—Ç–µ–º—É                       | –ü—Ä–æ—Å—Ç–æ–π 5-10 –º–∏–Ω—É—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏              |
| **–ù—É–ª–µ–≤–∞—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** | –ù–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ë–î, –Ω–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –ø–æ–≤—Ç–æ—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤                    | –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ—è—Ö                                |

#### 6. **–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
| **–£—è–∑–≤–∏–º–æ—Å—Ç—å**                | **–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞**                                                                 | **–†–∏—Å–∫**                                                                 |
|-------------------------------|-----------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö (`handlers/sensors.go`)                       | –õ—é–±–æ–π –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É                  |
| **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ë–î**        | –û–¥–∏–Ω –∫–æ–Ω–Ω–µ–∫—à–Ω –ø—É–ª –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (`db/db.go`)                                  | SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ                           |
| **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**   | –§–∞–π–ª docker-compose.yml —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ | –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è                           |

#### 7. **–ü—Ä–æ–±–ª–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏**
```mermaid
graph TD
    A[–ö–ª–∏–µ–Ω—Ç] --> B[–ó–∞–ø—Ä–æ—Å –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤]
    B --> C[PostgreSQL]
    C --> D[–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞]
    D --> E[–í–Ω–µ—à–Ω–∏–π API]
    E --> F[–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞]
    F --> G[–°–±–æ—Ä –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö]
    G --> H[–û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É]
```
**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- N+1 –ø—Ä–æ–±–ª–µ–º–∞: –¥–ª—è N –¥–∞—Ç—á–∏–∫–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
1. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–µ–∑–¥ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - –ù–µ—Ç API –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã**
   - –ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è —è–¥—Ä–∞
   - –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤

3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞**
   - –ú–∞–∫—Å–∏–º—É–º 500-1000 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å
   - –ì–µ–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞

4. **–†–∏—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ RBAC/ABAC
   - –ù–µ—Ç –∞—É–¥–∏—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è GDPR

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∏ >10 000 —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ SaaS —Å –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å—é
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏—è 99.9% uptime

–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞:
1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ï–¥–∏–Ω–∞—è –ë–î –Ω–∞ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–ì–∏–±–∫–æ—Å—Ç—å:** –ñ—ë—Å—Ç–∫–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

–†–µ—à–µ–Ω–∏–µ: –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Å —á—ë—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.

### 5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã¬†‚Äî –¥–∏–∞–≥—Ä–∞–º–º–∞ –°4

![](schemas/images/c4-context.png)

[c4-containers.puml](schemas/c4-context.puml)

# –ó–∞–¥–∞–Ω–∏–µ 2. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## **–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (Containers)**

![](schemas/c4/containers/c4-containers.png)

[c4-context.puml](schemas/c4/containers/c4-containers.puml)

## **–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (Components)**

### 1. API Gateway

![](schemas/c4/components/api-gateway.png)

[c4-components-api-gateway.puml](schemas/c4/components/api-gateway.puml)

### 2. Auth Service

![](schemas/c4/components/auth_service.png)

[c4-components-api-auth-service.puml](schemas/c4/components/auth_service.puml)

### 3. Device Service

![](schemas/c4/components/device-service-component.png)

[c4-components-device-service.puml](schemas/c4/components/device-service-component.puml)

### 4. Partner-Api-Gateway

![](schemas/c4/components/partner-api-gateway.png)

[c4-components-partner-api-gateway.puml](schemas/c4/components/partner-api-gateway.puml)

### 5. Rules Engine

![](schemas/c4/components/rules_engine.png)

[c4-components-rules_engine.puml](schemas/c4/components/rules_engine.puml)

## **–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–¥–∞ (Code)**

### 1. Device Service

![](schemas/c4/code/device-service/class.png)

[c4-code-device-service-class.puml](schemas/c4/code/device-service/class.puml)

# –ó–∞–¥–∞–Ω–∏–µ 3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã

![](schemas/er/er.png)

[c4-code-device-service-class.puml](schemas/er/er.puml)


# –ó–∞–¥–∞–Ω–∏–µ 4. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### 1. –¢–∏–ø API

- –î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–æ–π–¥–µ—Ç REST API.
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±—Ä–æ–∫–µ—Ä–∞–º–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

[**Swagger**](openapi/openapi.yaml)

# –ó–∞–¥–∞–Ω–∏–µ 5. –†–∞–±–æ—Ç–∞ —Å docker –∏ docker-compose

–°–µ—Ä–≤–∏—Å –∏ Dockerfile temperature-api –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Python FastAPI –∑–¥–µ—Å—å [temperature-api](apps/temperature-api)
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –ë–î –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ [docker-compose.yml](apps/docker-compose.yml)

# **–ó–∞–¥–∞–Ω–∏–µ 6. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ MVP**

## üè† MVP "–¢—ë–ø–ª—ã–π –î–æ–º"  
**–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–º–Ω—ã–º –¥–æ–º–æ–º —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π —Å –º–æ–Ω–æ–ª–∏—Ç–∞**

---

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ
- **3 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞** –Ω–∞ FastAPI (Python):
  - `Auth Service`: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏.
  - `Device Service`: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Ç–∏–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
  - `Rules Engine`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
- **Nginx API Gateway**: –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ –º–æ–Ω–æ–ª–∏—Ç–æ–º.
- **Strangler Fig**: –ù–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã ‚Äî –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, —Å—Ç–∞—Ä—ã–µ ‚Äî –≤ –º–æ–Ω–æ–ª–∏—Ç.
- **Docker + docker-compose**: –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é.
- **PostgreSQL**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.
- **Temperature API**: –ò–º–∏—Ç–∞—Ü–∏—è –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã.

---

### üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
smart-home-mvp/
‚îú‚îÄ‚îÄ auth-service/          # Auth Service
‚îú‚îÄ‚îÄ device-service/        # Device Service
‚îú‚îÄ‚îÄ rules-engine/          # Rules Engine
‚îú‚îÄ‚îÄ temperature-api/       # –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ smart_home/            # –ú–æ–Ω–æ–ª–∏—Ç (legacy)
‚îú‚îÄ‚îÄ api-gateway/           # API Gateway
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

---

### üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

---

### üåê API –°–µ—Ä–≤–∏—Å–æ–≤

**Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É FastAPI-—Å–µ—Ä–≤–∏—Å—É –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É /docs:**
- [Auth-Service](http://localhost:8082/docs/)
- [Device-Service](http://localhost:8083/docs/)
- [Rules-Engine](http://localhost:8084/docs/)


---

### üõ£Ô∏è API Gateway (Nginx)
- **–ü–æ—Ä—Ç**: `8080`
- **–ú–∞—Ä—à—Ä—É—Ç—ã**:
  - `/auth/...` ‚Üí `Auth Service`
  - `/devices/...` ‚Üí `Device Service`
  - `/scenarios/...` ‚Üí `Rules Engine`
  - –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Üí –ú–æ–Ω–æ–ª–∏—Ç (`app`)

–ü—Ä–∏–º–µ—Ä:
```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
POST http://localhost:8080/auth/register

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
POST http://localhost:8080/devices

# –°—Ç–∞—Ä—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç —á–µ—Ä–µ–∑ –º–æ–Ω–æ–ª–∏—Ç
GET http://localhost:8080/old-endpoint
```

---

### üó∫Ô∏è C4-–¥–∏–∞–≥—Ä–∞–º–º–∞ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)

![](schemas/c4/containers/mvp.png)

[c4-code-device-service-class.puml](schemas/c4/containers/mvp.puml)

### üó∫Ô∏è ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –ë–î MVP (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)

![](schemas/er/mvp-er.png)

[c4-code-device-service-class.puml](schemas/er/mvp-er.puml)

---

### üìà –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏
- **–î–æ–±–∞–≤–∏—Ç—å Kafka**: –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∏–≥–≥–µ—Ä—ã –≤ Rules Engine).
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Prometheus + Grafana –¥–ª—è –º–µ—Ç—Ä–∏–∫ —Å–µ—Ä–≤–∏—Å–æ–≤.
- **–¢–µ—Å—Ç—ã**: Unit-—Ç–µ—Å—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã.
- **–ú–∏–≥—Ä–∞—Ü–∏—è**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∏–∑ –º–æ–Ω–æ–ª–∏—Ç–∞ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ Nginx.
- **TO-BE**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ —à–∞–≥–µ 2

---

### üìå –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Backend**: Go, Python + FastAPI.
- **–ë–î**: PostgreSQL.
- **API Gateway**: Nginx.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**: Docker + docker-compose.
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Strangler Fig.
